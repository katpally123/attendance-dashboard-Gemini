<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Site Split Test</title>
</head>
<body>
    <h1>Site Split Functionality Test</h1>
    
    <h2>classifySite Function Test</h2>
    <div id="classifyTestResults"></div>
    
    <h2>aggregateSiteCounts Function Test</h2>
    <div id="aggregateTestResults"></div>
    
    <script src="site-split.js"></script>
    <script>
        // Test classifySite function
        function testClassifySite() {
            const testResults = document.getElementById('classifyTestResults');
            
            // Test cases based on the specification
            const testCases = [
                // YHM2-SDC cases (Inbound)
                { input: { deptId: 1211010, area: 0 }, expected: "YHM2-SDC", desc: "Inbound dept 1211010" },
                { input: { deptId: 1211020, area: 0 }, expected: "YHM2-SDC", desc: "Inbound dept 1211020" },
                { input: { deptId: 1299010, area: 0 }, expected: "YHM2-SDC", desc: "Inbound dept 1299010" },
                { input: { deptId: 1299020, area: 0 }, expected: "YHM2-SDC", desc: "Inbound dept 1299020" },
                
                // YHM2-SDC cases (DA)
                { input: { deptId: 1211030, area: 0 }, expected: "YHM2-SDC", desc: "DA dept 1211030" },
                { input: { deptId: 1211040, area: 0 }, expected: "YHM2-SDC", desc: "DA dept 1211040" },
                { input: { deptId: 1299030, area: 0 }, expected: "YHM2-SDC", desc: "DA dept 1299030" },
                { input: { deptId: 1299040, area: 0 }, expected: "YHM2-SDC", desc: "DA dept 1299040" },
                
                // ICQA case
                { input: { deptId: 1299070, area: 27 }, expected: "ICQA", desc: "ICQA area 27" },
                { input: { deptId: 1211070, area: 27 }, expected: "ICQA", desc: "ICQA area 27 alt dept" },
                
                // YDD2-IXD case
                { input: { deptId: 1299070, area: 22 }, expected: "YDD2-IXD", desc: "CRETs area 22" },
                { input: { deptId: 1211070, area: 22 }, expected: "YDD2-IXD", desc: "CRETs area 22 alt dept" },
                
                // Other cases
                { input: { deptId: 9999999, area: 99 }, expected: "Other", desc: "Unknown dept and area" },
                { input: { deptId: 1299070, area: 50 }, expected: "Other", desc: "Known dept but different area" }
            ];
            
            let results = '<ul>';
            let allPassed = true;
            
            testCases.forEach(testCase => {
                const result = classifySite(testCase.input);
                const passed = result === testCase.expected;
                allPassed = allPassed && passed;
                
                results += `<li style="color: ${passed ? 'green' : 'red'}">
                    ${testCase.desc}: Expected "${testCase.expected}", got "${result}" 
                    ${passed ? '✓' : '✗'}
                </li>`;
            });
            
            results += '</ul>';
            results = `<p><strong>All tests ${allPassed ? 'PASSED' : 'FAILED'}</strong></p>` + results;
            testResults.innerHTML = results;
        }
        
        // Test aggregateSiteCounts function
        function testAggregateSiteCounts() {
            const testResults = document.getElementById('aggregateTestResults');
            
            // Mock department data structure
            const mockRowData = {
                Inbound: { AMZN: 10, TEMP: 5, TOTAL: 15 },
                DA: { AMZN: 8, TEMP: 3, TOTAL: 11 },
                ICQA: { AMZN: 12, TEMP: 4, TOTAL: 16 },
                CRETs: { AMZN: 6, TEMP: 2, TOTAL: 8 },
                Other: { AMZN: 1, TEMP: 1, TOTAL: 2 }
            };
            
            const result = aggregateSiteCounts(mockRowData);
            
            // Expected results:
            // YHM2-SDC = Inbound + DA = (10+8, 5+3, 15+11) = (18, 8, 26)
            // ICQA = ICQA = (12, 4, 16)
            // YDD2-IXD = CRETs = (6, 2, 8)
            // Other = Other = (1, 1, 2)
            
            const expected = {
                "YHM2-SDC": { AMZN: 18, TEMP: 8, TOTAL: 26 },
                "ICQA": { AMZN: 12, TEMP: 4, TOTAL: 16 },
                "YDD2-IXD": { AMZN: 6, TEMP: 2, TOTAL: 8 },
                "Other": { AMZN: 1, TEMP: 1, TOTAL: 2 }
            };
            
            let results = '<ul>';
            let allPassed = true;
            
            Object.keys(expected).forEach(site => {
                const actualSite = result[site];
                const expectedSite = expected[site];
                
                ['AMZN', 'TEMP', 'TOTAL'].forEach(type => {
                    const passed = actualSite[type] === expectedSite[type];
                    allPassed = allPassed && passed;
                    
                    results += `<li style="color: ${passed ? 'green' : 'red'}">
                        ${site}.${type}: Expected ${expectedSite[type]}, got ${actualSite[type]} 
                        ${passed ? '✓' : '✗'}
                    </li>`;
                });
            });
            
            results += '</ul>';
            results = `<p><strong>All tests ${allPassed ? 'PASSED' : 'FAILED'}</strong></p>` + results;
            testResults.innerHTML = results;
        }
        
        // Run tests
        testClassifySite();
        testAggregateSiteCounts();
    </script>
</body>
</html>